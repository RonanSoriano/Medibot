<!DOCTYPE html>
<html>
<head>
    <title>Medibot</title>
    <link href="{{ url_for('static', filename='index.css') }}" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karla:400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Updated -->
    <style>

    html, body {
        height: 100%;
        overflow-x: hidden; /* Hide horizontal scrollbar */
        transition: background-color 0.3s ease; /* Add transition for smooth mode change */
    }

    body {
        margin: 0;
        padding: 0;
        width: 100%;
        display: table;
        font-weight: 100;
        font-family: 'Karla';
        background-color:#9fc5fd;
    }

    /* Dark mode styles */
    body.dark-mode {
        background-color: #333;
        color: #fff;
    }


    .caret {
    display: none; /* Hide the dropdown arrow */
}

    .opt {
        margin-top: 30px;
    }

    .opt a {
        text-decoration: none;
        font-size: 150%;
    }

    a:hover {
        color: rgb(0, 0, 0);
        text-decoration: none;
    }


    input:checked + .toggle-slider {
        background-color: #2196F3;
    }

    input:checked + .toggle-slider:before {
        transform: translateX(26px);
    }

    /* Dark mode text */
    .dark-mode-text {
        color: #333; /* Dark gray text color */
        font-size: 14px;
        margin-left: 5px; /* Adjust spacing between switch and text */
    }

    /* Adjusted CSS */
    .dropdown-menu {
        max-height: calc(100vh - 150px); /* Adjusted max-height */
        overflow-y: auto; /* Added overflow-y to enable scrolling */
    }

    /* Text area styles */
    textarea {
        background-color: #f5f5f5; /* Light gray background color */
        color: #333; /* Dark gray text color */
        border: none;
        border-radius: 15px; /* Round border corners */
        padding: 10px 15px; /* Add padding for better appearance */
        font-size: 16px; /* Adjust font size */
        outline: none; /* Remove outline when focused */
        resize: none; /* Disable resizing */
        width: calc(100% - 30px); /* Calculate width to fit within parent */
    }

    /* Send button styles */
    .send-btn, .clear-history-btn {
        background-color: #9fc5fd; /* Blue background color */
        color: #fff; /* White text color */
        border: none; /* Remove border */
        padding: 10px 20px; /* Add padding */
        font-size: 16px; /* Increase font size */
        border-radius: 15px; /* Round border corners */
        cursor: pointer; /* Add pointer cursor */
        transition: background-color 0.3s; /* Smooth transition */
    }

    .send-btn:hover, .clear-history-btn:hover {
        background-color: #444444; /* Darker blue on hover */
    }

        /* Styling the scrollbar */
    /* Width */
    ::-webkit-scrollbar {
    width: 8px; /* Width of the scrollbar */
    }

    /* Track */
    ::-webkit-scrollbar-track {
    background: transparent; /* Track color */
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
    background: #ccc; /* Handle color */
    border-radius: 10px; /* Roundness of the handle */
    }

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
    background: #999; /* Handle color on hover */
    }

    /* Dark mode scrollbar */
    body.dark-mode ::-webkit-scrollbar-thumb {
    background: #666; /* Dark mode handle color */
    }


    /* Close button */
    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    .clear-chat-btn {
        background-color: #ff6c4f; /* Red background color */
        color: #fff; /* White text color */
        border: none; /* Remove border */
        padding: 10px 20px; /* Add padding */
        font-size: 16px; /* Font size */
        border-radius: 15px; /* Rounded corners */
        cursor: pointer; /* Cursor style */
        margin-left: 10px; /* Adjust spacing */
    }

    .clear-chat-btn:hover {
        background-color: #cc4125; /* Darker red on hover */
    }


    /* Medibot Background Color */
    .center-color {
    background-color: #fff;
    margin: 0 auto;
    padding: 1px;
    margin-right: 220px;
    margin-left: 750px;
    display: absolute;
    border-radius: 50px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  }

    /* Adjusted position of the send and clear buttons */
    .send-btn,
    .clear-history-btn,
    .clear-chat-btn {
        position: relative;
        top: -50px;
    }

    /* Adjusted position of the chat input */
    .chat-input {
        margin-top: 20px; /* Adjust as needed */
        margin-bottom: 50px;
        position: absolute;
        margin-left: 180px;
    }

    footer {
        margin-top: 20px;
        padding: 20px;
        background-color: #9fc5fd;
        display: block;
        text-align: center;
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        color: #fff;
        z-index: 10; /* Ensure footer stays on top */
    }

    /*
    .chat-input {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        background-color: #fff;
        padding: 10px 20px;
        box-shadow: 0px -2px 5px rgba(0, 0, 0, 0.1);
        z-index: 20; 
    } 
    */

    .chat-input button {
        width: 120px; /* Adjust width of buttons */
    }

    /* Adjust the position of the send and clear buttons */
    .send-btn,
    .clear-history-btn,
    .clear-chat-btn {
        position: relative;
        top: 0;
    }
    .logo {
    max-height: 50px; /* Limit the height of the logo */
    max-width: 150px; /* Limit the width of the logo */
    margin-left: 30px; /* Add spacing to the left of the logo */
    margin-right: 10px; /* Add some spacing to the right of the logo */
    margin-top: 13px;
    }

    /* Divider for the center elements like chatbot, bubble chat, etc */
    .divider {
        margin: 0 auto;
        padding: 5px;
        display: flex;
    }
    
    .header1 {
        display: fixed;
    }

    .left-panel {
        position: fixed;
        display: fixed;
    }

    .medibot-image { /* Updated All */
        position: absolute;
        top: 490px;
        left: 87%;
        transform: translateX(-50%);
        z-index: 100;
    }

    .bubblechat {
        justify-content: space-between;
        position: absolute;
        width: 700px; 
        background: white;
        position: relative;
        border-radius: 50px;
        left: 20px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        animation: fade-up 0.9s;
    }

    .bubbletail{
        content: '';
        position: absolute;
        left: 81%;
        top: 420px; 
        width: 0;
        height: 0;
        border-top: 60px solid white;
        border-left: 60px solid transparent;
    }

    .bubble-text {
        padding: 55px;
        font-size: 20px;
        text-align: justify;
        max-width: 700px; 
        word-wrap: break-word; 
        animation: fade-up 3s;
    }

    .font1 { /* Updated All */
        margin: 50px;
        padding: 7px;
        color: white;
        font-weight: bold;
        font-size: 60px;
        font-family: 'Poppins';
        animation: fade-up 0.9s;
    }

    /* Transition */
    @keyframes fade-down {
        0% {
            opacity: 0;
            transform: translateY(30px) scale(0.9);
        }

        100% {
            opacity: 1;
            transform: translateY(0px) scale(1);
        }
    }

    @keyframes fade-up {
        0% {
            opacity: 0;
            transform: translateY(0) scale(0.9); /* Move element up and scale down */
            transform-origin: center; /* Set the transform origin to the center */
        }
    
        100% {
            opacity: 1;
            transform: translateY(0) scale(1); /* Return to original position and scale */
            transform-origin: center; /* Maintain the center transform origin */
        }
    }

    @keyframes typing-animation {
        from { width: 0; }
        to { width: 100%; }
    }

    </style>
</head>
<body>
<!-- Header -->
<nav class="header1">
    <a href="/">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="MediBot Logo" class="logo" style="max-height: 50px; max-width: 150px;">
    </a>
    <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/chatbot">ChatBot</a></li>
        <li><a href="/forum">Forum</a></li>
        <li><a href="/contact">Contact Us</a></li> <!-- Link to Contact Us page -->
    </ul>
</nav>

<br>
<br>
<br>
<br>

<div class="divider">
    <div class="left-panel">
        <div class="bubblechat">
            <div class="bubble-text">
                <p>
                    While our website's chatbot provides valuable insights and assistance 
                    on health-related inquiries, it's important to note its limitations. 
                    Our chatbot is designed to offer general information and guidance on 
                    healthcare topics, but it does not have the authority to prescribe 
                    specific medications or treatments. Healthcare decisions should always 
                    be made in consultation with a qualified medical professional. 
                    Additionally, while our chatbot strives to provide accurate and up-to-date 
                    information, it may not be able to address all possible scenarios or medical
                    conditions. Users should exercise caution and seek professional medical 
                    advice for personalized healthcare needs.
                </p>
            </div>
            <div class="bubbletail"></div>
        </div>

        <!-- UPDATED ALL -->
        <p class="font1"> Hi, I'm MediBot <br> your personal <br> medicare <br> assistant!</p>
        <!-- END -->

        <img src="static/medibot.png" width="210" height="370" class="medibot-image"> 
    </div>

    <!-- MediBot -->
<div class="center-color"> 
    <div class="medibot">
        <header>
            <h2>MediBot</h2>
        </header>
        <!-- Chat container -->
        <ul id="chat-container" class="chatbox">
            <!-- Bot's initial message -->
            <li class="chat incoming">
                <span class="material-symbols-outlined">smart_toy</span>
                <p>Hi, I'm MediBot. How can I help you today?</p>
            </li>
        </ul>

       <!-- Chat input -->
       <div class="chat-input">
        <textarea id="user-input" placeholder="Enter a message..." required></textarea>
        <button id="send-btn" class="send-btn material-symbols-outlined">Send</button>
        <!-- Clear message history button -->
        <button id="clear-chat-btn" class="clear-history-btn material-symbols-outlined">&#128465;</button>
        <button id="clear-history-btn" class="clear-chat-btn material-symbols-outlined">Clear Chat</button>
    </div>
</div>
   
    </div>
    </div>
    </div>
</div>
<!--
<footer>
    <span>&copy;  Made by C.A.R.E | All Rights Reserved</span>
</footer>
-->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script>
        // Function to send a message to the chatbot
        function sendMessage(message) {
            var userInput = message.trim(); // Trim whitespace from input
            if (userInput !== '') { // Check if input is not empty
                $('#chat-container').append('<li class="chat outgoing"><p>' + userInput + '</p></li>');
                // Send user input to Flask endpoint
                $.ajax({
                    type: 'POST',
                    url: '/chat',
                    contentType: 'application/json',
                    data: JSON.stringify({'user_input': userInput}),
                    success: function(response) {
                        var botResponse = response.response;
                        $('#chat-container').append('<li class="chat incoming"><span class="material-symbols-outlined">smart_toy</span><p>' + botResponse + '</p></li>');
                        scrollToBottom(); // Scroll to the bottom after adding the message
                    },
                    error: function(xhr, status, error) {
                        console.error("AJAX request error:", error);
                    }
                });
                clearChatInput(); // Clear chat input after sending message
            }
        }

        // Function to clear chat input
        function clearChatInput() {
            $('#user-input').val(''); // Clear the chat input
        }

        // Function to scroll to the bottom of the chat container
        function scrollToBottom() {
            var chatContainer = $('#chat-container');
            chatContainer.scrollTop(chatContainer.prop('scrollHeight'));
        }

        $(document).ready(function() {
            // Check if there is a message in the URL parameter
            var urlParams = new URLSearchParams(window.location.search);
            var message = urlParams.get('message');
            if (message) {
                // Set the message to the chat input and send it automatically
                $('#user-input').val(message);
                sendMessage(message);
            }

            $('#send-btn').click(function() {
                sendMessage($('#user-input').val()); // Send message when Send button is clicked
            });

            $('#user-input').keypress(function(event) {
                if (event.keyCode == 13) {
                    event.preventDefault(); // Prevent default Enter key behavior
                    sendMessage($('#user-input').val()); // Send message when Enter is pressed
                }
            });

            // Clear message history button functionality
            $('#clear-history-btn').click(function() {
                $('#chat-container').empty(); // Remove all chat messages
                // Add initial bot message after clearing chat history
                $('#chat-container').append('<li class="chat incoming"><span class="material-symbols-outlined">smart_toy</span><p>Hi, I\'m MediBot. How can I help you today?</p></li>');
                clearChatInput(); // Clear chat input as well
            });

            // Clear chat input button functionality
            $('#clear-chat-btn').click(function() {
                clearChatInput(); // Clear chat input when Clear Chat button is clicked
            });

            // Scroll to the bottom when the page is loaded
            scrollToBottom();
        });
    </script>

</body>
</html>
